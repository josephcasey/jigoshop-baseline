jQuery(function(t){"use strict";var a=jigoshop_countries;t(".shipping-calculator-form").hide(),t(".shipping-calculator-button").click(function(){t(".shipping-calculator-form").slideToggle("slow",function(){})}),t(".shipping-calculator-button").click(function(){return!1}),t("input[name=shipping_rates]").click(function(){var a="shipping_rates="+t(this).val(),e=t("input[name=cart-url]").val();t(".cart_totals_table").block({message:null,overlayCSS:{background:"#fff url("+jigoshop_params.assets_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}}),t.ajax({type:"POST",url:e,data:a,success:function(a){var e=t(a);t(".cart_totals_table").replaceWith(e.find(".cart_totals_table")),t(".cart_totals_table").unblock()}})}),t("select.country_to_state").change(function(){var e=t(this).val(),i=t("#"+t(this).attr("rel")),s=t(i).attr("name"),o=t(i).attr("id");if(a[e]){var r="",l=a[e],n=jigoshop_params.billing_state;n="calc_shipping_state"==s?t("#calc_shipping_state").val():"billing-state"==s?jigoshop_params.billing_state:jigoshop_params.shipping_state;for(var c in l)r=n==c?r+'<option value="'+c+'" selected="selected">'+l[c]+"</option>":r+'<option value="'+c+'">'+l[c]+"</option>";if(t(i).is("input")){var p=t(i).prev().find("span.required");void 0==p.val()&&t(i).prev().append(' <span class="required">*</span>'),t(i).replaceWith('<select name="'+s+'" id="'+o+'"><option value="">'+jigoshop_params.select_state_text+"</option></select>"),i=t("#"+t(this).attr("rel"))}t(i).html(r)}else t(i).is("select")&&(t(i).prev().find("span.required").remove(),t(i).replaceWith('<input class="input-text" type="text" placeholder="'+jigoshop_params.state_text+'" name="'+s+'" id="'+o+'" />'),i=t("#"+t(this).attr("rel")))}),t("td.product-quantity").on("change","input.qty",function(){var a=t(this).closest("tr"),e=t(".form-cart-items");e.block({message:null,overlayCSS:{background:"#fff url("+jigoshop_params.assets_url+"/assets/images/ajax-loader.gif) no-repeat center",opacity:.6}}),t.ajax(jigoshop_params.ajax_url,{type:"post",dataType:"json",data:{action:"jigoshop_update_item_quantity",qty:t(this).val(),item:a.data("item")}}).done(function(i){if(e.unblock(),i.success){e.trigger("jigoshop.cart.update",[a,i]),-1===i.item_price?a.remove():(t("td.product-subtotal",a)&&t("td.product-subtotal",a).html(i.item_price),t("td.product-total",a)&&t("td.product-total",a).html(i.item_price));var s=t("div.cart_totals_table");t(".cart-row-subtotal",s).html(i.subtotal),t(".cart-row-total",s).html(i.total);var o=t(".cart-row-shipping",s);o.length&&o.html(i.shipping);var r=t(".cart-row-discount",s);r.length&&(r.html(i.discount),"-"==i.discount&&(t(".applied-coupons").remove(),t(".discount").remove()));for(var l in i.tax)t('tr[data-tax="'+l+'"] .cart-row-tax',s).html(i.tax[l])}})}).on("click",".plus, .minus",function(){t("input.qty",t(this).closest("td.product-quantity")).trigger("change")})});
